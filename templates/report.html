{% extends 'main.html' %}

{% block body_content %}
<div class="min-h-screen flex items-center justify-center bg-gray-100">
    <div class="max-w-3xl bg-white p-6 rounded-lg shadow-md">
        <h2 class="text-2xl font-bold text-center mb-4">Vulnerability Scan Report</h2>

        <!-- âœ… Ensure Graph is Displayed -->
        <div class="flex justify-center">
            {% if chart_image %}
                <img src="data:image/png;base64,{{ chart_image }}" alt="Vulnerability Chart" class="rounded shadow-lg">
            {% else %}
                <p class="text-center text-gray-600">No vulnerabilities detected.</p>
            {% endif %}
        </div>

        <div class="mt-6">
            <h3 class="text-lg font-semibold">Scan Summary:</h3>
            <ul class="list-disc pl-6 mt-2 text-gray-700">
                <li><strong>XSS Attack:</strong> {{ scan_results.xss }}</li>
                <li><strong>SQL Injection:</strong> {{ scan_results.sqli }}</li>
                <li><strong>JavaScript Injection:</strong> {{ scan_results.js }}</li>
                <li><strong>Remote Code Execution:</strong> {{ scan_results.rce }}</li>
                <li><strong>Form Vulnerabilities:</strong> {{ scan_results.form_vuln }}</li>
            </ul>
        </div>

        <div class="mt-6 flex justify-center">
            <a href="/" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                Run Another Scan
            </a>
        </div>
    </div>
</div>
{% endblock %}
